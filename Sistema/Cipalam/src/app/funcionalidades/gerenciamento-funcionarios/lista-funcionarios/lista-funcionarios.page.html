<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/sistema/dashboard"></ion-back-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding-horizontal">
  <div class="content-container">
    <!-- Header com título e descrição -->
    <div class="page-header">
      <div class="header-content">
        <div class="header-info">
          <h1>Lista de Funcionários</h1>
          <p>Gerencie todos os funcionários do sistema</p>
        </div>
        <div class="header-illustration">
          <ion-icon name="people-outline"></ion-icon>
        </div>
      </div>
    </div>

    <!-- Pesquisa Estilo Gmail -->
    <div class="pesquisa-gmail">
      <div class="search-container">
        <ion-searchbar 
          [(ngModel)]="filtroTexto" 
          (ionInput)="aplicarFiltros()"
          placeholder="Pesquisar funcionários" 
          debounce="300"
          show-clear-button="focus"
          class="gmail-search">
        </ion-searchbar>
        
        <ion-button 
          fill="clear" 
          size="small" 
          class="filtros-toggle"
          (click)="toggleFiltrosAvancados()"
          [class.ativo]="mostrarFiltrosAvancados">
          <ion-icon name="options-outline"></ion-icon>
        </ion-button>
      </div>
      
      <!-- Filtros integrados -->
      <div class="filtros-inline" *ngIf="mostrarFiltrosAvancados">
        <div class="filtro-chips">
          <ion-chip 
            [color]="filtroStatus === 'ativo' ? 'success' : 'medium'"
            (click)="toggleFiltroStatus('ativo')"
            [outline]="filtroStatus !== 'ativo'">
            <ion-label>Ativos</ion-label>
          </ion-chip>
          
          <ion-button 
            fill="clear" 
            size="small" 
            (click)="limparFiltros()"
            *ngIf="filtroStatus || filtroTexto">
            <ion-icon name="close" slot="start"></ion-icon>
            Limpar
          </ion-button>
        </div>
      </div>
    </div>

    <!-- Lista de Funcionários em Tabela -->
    <div class="funcionarios-lista">
      <div class="lista-header">
        <h2>
          Funcionários Cadastrados
          <ion-badge color="primary">{{ funcionariosFiltrados.length }}</ion-badge>
        </h2>

        <ion-button *ngIf="podeGerenciarFuncionarios" (click)="navegarParaCadastro()" color="primary">
          <ion-icon name="add" slot="start"></ion-icon>
          Novo Funcionário
        </ion-button>
      </div>

      <!-- Loading -->
      <div *ngIf="loading" class="loading-container">
        <ion-spinner name="crescent"></ion-spinner>
        <p>Carregando funcionários...</p>
      </div>

      <!-- Lista vazia -->
      <div *ngIf="!loading && funcionariosFiltrados.length === 0" class="lista-vazia">
        <ion-icon name="people-outline" color="medium"></ion-icon>
        <h3>Nenhum funcionário encontrado</h3>
        <p>
          <span *ngIf="filtroTexto || filtroStatus">
            Tente ajustar os filtros ou
          </span>
          <span *ngIf="podeGerenciarFuncionarios">
            <ion-button fill="clear" (click)="navegarParaCadastro()">
              cadastrar um novo funcionário
            </ion-button>
          </span>
        </p>
      </div>

      <!-- Tabela de Funcionários -->
      <div *ngIf="!loading && funcionariosFiltrados.length > 0" class="tabela-container">
        <table class="funcionarios-table">
          <thead>
            <tr>
              <th>Nome</th>
              <th>Email</th>
              <th>Usuário</th>
              <th>Status</th>
              <th>Ações</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let funcionario of funcionariosFiltrados" class="funcionario-row">
              <td class="nome-funcionario">
                <div class="funcionario-info">
                  <h3>{{ funcionario.nome }}</h3>
                </div>
              </td>
              
              <td class="email">
                <div class="email-info">
                  {{ funcionario.email }}
                </div>
              </td>
              
              <td class="usuario">
                <div class="usuario-info">
                  {{ funcionario.usuario }}
                </div>
              </td>
              
              <td class="status">
                <ion-chip color="success" outline>
                  <ion-icon name="checkmark-circle"></ion-icon>
                  <ion-label>Ativo</ion-label>
                </ion-chip>
              </td>
              
              <td class="acoes">
                <div class="acoes-container">
                  <ion-button *ngIf="podeGerenciarFuncionarios" fill="clear" size="small" (click)="editarFuncionario(funcionario.id)">
                    <ion-icon name="create" slot="icon-only"></ion-icon>
                  </ion-button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</ion-content>