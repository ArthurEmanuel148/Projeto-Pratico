<ion-content [fullscreen]="true" class="cadastro-content">
    <div class="form-container">
        <!-- Header da página -->
        <div class="page-header">
            <div class="header-content">
                <div class="header-info">
                    <h1>{{ isEditMode ? 'Editar Tipo de Documento' : 'Novo Tipo de Documento' }}</h1>
                    <p>{{ isEditMode ? 'Atualize as informações do tipo de documento' : 'Configure um novo tipo de documento para o sistema' }}</p>
                </div>
                <div class="header-illustration">
                    <ion-icon name="document-text-outline"></ion-icon>
                </div>
            </div>
        </div>

        <!-- Formulário -->
        <form [formGroup]="tipoDocumentoForm" class="form-wrapper">
            <!-- Seção: Informações Básicas -->
            <div class="form-section">
                <div class="section-header">
                    <div class="section-icon">
                        <ion-icon name="information-circle-outline"></ion-icon>
                    </div>
                    <div class="section-title">
                        <h2>Informações Básicas</h2>
                        <p>Dados fundamentais do tipo de documento</p>
                    </div>
                </div>

                <div class="form-group">
                    <ion-item [class.item-has-value]="nome?.value" [class.item-has-focus]="nome?.value">
                        <ion-label position="floating">Nome do Documento <ion-text color="danger">*</ion-text></ion-label>
                        <ion-input formControlName="nome" maxlength="100"
                            (ionFocus)="onInputFocus($event, 'Ex: Certidão de Nascimento')" (ionBlur)="onInputBlur($event)">
                        </ion-input>
                    </ion-item>

                    <ion-item [class.item-has-value]="descricao?.value">
                        <ion-label position="floating">Descrição</ion-label>
                        <ion-textarea formControlName="descricao" rows="3"
                            maxlength="500" (ionFocus)="onInputFocus($event, 'Descreva o propósito e quando este documento é necessário')" (ionBlur)="onInputBlur($event)">
                        </ion-textarea>
                    </ion-item>
                </div>
            </div>

            <!-- Seção: Configurações -->
            <div class="form-section">
                <div class="section-header">
                    <div class="section-icon">
                        <ion-icon name="settings-outline"></ion-icon>
                    </div>
                    <div class="section-title">
                        <h2>Configurações</h2>
                        <p>Defina como o documento deve se comportar no sistema</p>
                    </div>
                </div>

                <div class="form-group">
                    <div class="field-header">
                        <h3>Quem Deve Fornecer <ion-text color="danger">*</ion-text></h3>
                        <p>Quem deve fornecer este documento</p>
                    </div>

                    <div class="button-options">
                        <ion-button [fill]="quemForneceSelecionado === 'RESPONSAVEL' ? 'solid' : 'outline'"
                            [color]="quemForneceSelecionado === 'RESPONSAVEL' ? 'success' : 'light'"
                            (click)="selecionarQuemFornece('RESPONSAVEL')" class="option-button">
                            <ion-icon name="person-outline"></ion-icon>
                            <div class="button-content">
                                <div class="button-title">Responsável</div>
                                <div class="button-subtitle">Apenas o responsável</div>
                            </div>
                        </ion-button>

                        <ion-button [fill]="quemForneceSelecionado === 'ALUNO' ? 'solid' : 'outline'"
                            [color]="quemForneceSelecionado === 'ALUNO' ? 'success' : 'light'"
                            (click)="selecionarQuemFornece('ALUNO')" class="option-button">
                            <ion-icon name="school-outline"></ion-icon>
                            <div class="button-content">
                                <div class="button-title">Aluno</div>
                                <div class="button-subtitle">Apenas o aluno</div>
                            </div>
                        </ion-button>

                        <ion-button [fill]="quemForneceSelecionado === 'TODOS_INTEGRANTES' ? 'solid' : 'outline'"
                            [color]="quemForneceSelecionado === 'TODOS_INTEGRANTES' ? 'success' : 'light'"
                            (click)="selecionarQuemFornece('TODOS_INTEGRANTES')" class="option-button">
                            <ion-icon name="people-outline"></ion-icon>
                            <div class="button-content">
                                <div class="button-title">Todos os Integrantes</div>
                                <div class="button-subtitle">Todos da família</div>
                            </div>
                        </ion-button>

                        <ion-button [fill]="quemForneceSelecionado === 'FAMILIA' ? 'solid' : 'outline'"
                            [color]="quemForneceSelecionado === 'FAMILIA' ? 'success' : 'light'"
                            (click)="selecionarQuemFornece('FAMILIA')" class="option-button">
                            <ion-icon name="home-outline"></ion-icon>
                            <div class="button-content">
                                <div class="button-title">Família</div>
                                <div class="button-subtitle">Documento da família</div>
                            </div>
                        </ion-button>
                    </div>

                    <!-- Campo hidden para o FormControl -->
                    <input type="hidden" formControlName="quemDeveFornencer" />
                </div>
            </div>

            <!-- Seção: Status -->
            <div class="form-section">
                <div class="section-header">
                    <div class="section-icon">
                        <ion-icon name="toggle-outline"></ion-icon>
                    </div>
                    <div class="section-title">
                        <h2>Status</h2>
                        <p>Controle de disponibilidade do documento</p>
                    </div>
                </div>

                <div class="form-group">
                    <ion-item>
                        <ion-toggle formControlName="ativo" slot="start"></ion-toggle>
                        <ion-label>
                            <h3>Documento Ativo</h3>
                            <p>O documento está disponível para uso no sistema</p>
                        </ion-label>
                    </ion-item>
                </div>
            </div>

            <!-- Botões de Ação -->
            <div class="form-actions">
                <ion-button fill="clear" color="medium" size="large" (click)="cancelar()">
                    <ion-icon name="close-outline" slot="start"></ion-icon>
                    Cancelar
                </ion-button>

                <ion-button *ngIf="isEditMode" fill="clear" color="danger" size="large" (click)="confirmarExclusao()">
                    <ion-icon name="trash-outline" slot="start"></ion-icon>
                    Excluir
                </ion-button>

                <ion-button type="submit" color="primary" size="large" [disabled]="tipoDocumentoForm.invalid" (click)="salvar()">
                    <ion-icon name="checkmark-outline" slot="start"></ion-icon>
                    {{ isEditMode ? 'Atualizar' : 'Criar' }}
                </ion-button>
            </div>
        </form>
    </div>
</ion-content>