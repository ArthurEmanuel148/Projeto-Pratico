<ion-content [fullscreen]="true" class="cadastro-content">
    <div class="form-container">
        <!-- Header da página -->
        <div class="page-header">
            <div class="header-content">
                <div class="header-info">
                    <h1>{{ isEditMode ? 'Editar Turma' : 'Nova Turma' }}</h1>
                    <p>{{ isEditMode ? 'Altere as informações da turma' : 'Preencha as informações principais da turma' }}</p>
                </div>
                <div class="header-illustration">
                    <ion-icon name="school-outline"></ion-icon>
                </div>
            </div>
        </div>

        <!-- Formulário -->
        <form [formGroup]="cadastroForm" class="form-wrapper">

            <!-- Seção: Dados da Turma -->
            <div class="form-section">
                <div class="section-header">
                    <div class="section-icon">
                        <ion-icon name="library-outline"></ion-icon>
                    </div>
                    <div class="section-title">
                        <h2>Dados da Turma</h2>
                        <p>Informações básicas da turma</p>
                    </div>
                </div>
                <div class="form-group form-field-container">
                    <ion-item (click)="focusInput('nomeTurma')" [class.item-invalid]="isFieldInvalid('nomeTurma')"
                        [class.item-valid]="isFieldValid('nomeTurma')">
                        <ion-label position="floating">Nome da Turma <ion-text color="danger">*</ion-text></ion-label>
                        <ion-input type="text" formControlName="nomeTurma" (ionFocus)="onInputFocus($event)"
                            (ionBlur)="onInputBlur($event)" required></ion-input>
                    </ion-item>
                    <div *ngIf="getFieldError('nomeTurma')" class="error-message">
                        {{ getFieldError('nomeTurma') }}
                    </div>
                </div>
                
                <div class="form-group form-field-container">
                    <ion-item (click)="focusInput('capacidadeMaxima')" [class.item-invalid]="isFieldInvalid('capacidadeMaxima')"
                        [class.item-valid]="isFieldValid('capacidadeMaxima')">
                        <ion-label position="floating">Capacidade Máxima <ion-text color="danger">*</ion-text></ion-label>
                        <ion-input type="number" formControlName="capacidadeMaxima" (ionFocus)="onInputFocus($event)"
                            (ionBlur)="onInputBlur($event)" min="1" max="50" required></ion-input>
                    </ion-item>
                    <div *ngIf="getFieldError('capacidadeMaxima')" class="error-message">
                        {{ getFieldError('capacidadeMaxima') }}
                    </div>
                </div>
            </div>

            <!-- Seção: Horários de Funcionamento -->
            <div class="form-section">
                <div class="section-header">
                    <div class="section-icon">
                        <ion-icon name="time-outline"></ion-icon>
                    </div>
                    <div class="section-title">
                        <h2>Horários de Funcionamento</h2>
                        <p>Defina os horários de início e fim das aulas</p>
                    </div>
                </div>
                <div class="form-group form-field-container">
                    <ion-item (click)="focusInput('horarioInicio')" [class.item-invalid]="isFieldInvalid('horarioInicio')"
                        [class.item-valid]="isFieldValid('horarioInicio')">
                        <ion-label position="floating">Horário de Início <ion-text color="danger">*</ion-text></ion-label>
                        <ion-input type="time" formControlName="horarioInicio" (ionFocus)="onInputFocus($event)"
                            (ionBlur)="onInputBlur($event)" required></ion-input>
                    </ion-item>
                    <div *ngIf="getFieldError('horarioInicio')" class="error-message">
                        {{ getFieldError('horarioInicio') }}
                    </div>
                </div>
                
                <div class="form-group form-field-container">
                    <ion-item (click)="focusInput('horarioFim')" [class.item-invalid]="isFieldInvalid('horarioFim')"
                        [class.item-valid]="isFieldValid('horarioFim')">
                        <ion-label position="floating">Horário de Fim <ion-text color="danger">*</ion-text></ion-label>
                        <ion-input type="time" formControlName="horarioFim" (ionFocus)="onInputFocus($event)"
                            (ionBlur)="onInputBlur($event)" required></ion-input>
                    </ion-item>
                    <div *ngIf="getFieldError('horarioFim')" class="error-message">
                        {{ getFieldError('horarioFim') }}
                    </div>
                </div>
            </div>

            <!-- Seção: Informações Adicionais -->
            <div class="form-section">
                <div class="section-header">
                    <div class="section-icon">
                        <ion-icon name="information-circle-outline"></ion-icon>
                    </div>
                    <div class="section-title">
                        <h2>Informações Adicionais</h2>
                        <p>Observações e configurações da turma</p>
                    </div>
                </div>
                <div class="form-group">
                    <ion-item>
                        <ion-label position="floating">Observações</ion-label>
                        <ion-textarea formControlName="observacoes" (ionFocus)="onInputFocus($event)" (ionBlur)="onInputBlur($event)" rows="3" autoGrow="true"></ion-textarea>
                    </ion-item>
                    <ion-item class="turma-ativa-item">
                        <ion-toggle formControlName="ativo" slot="start"></ion-toggle>
                        <ion-label>
                            <h3>Turma Ativa</h3>
                            <p>Marque se a turma estará disponível para matrículas</p>
                        </ion-label>
                    </ion-item>
                </div>
            </div>

            <!-- Botões de Ação -->
            <div class="form-actions">
                <ion-button fill="clear" color="medium" size="large" (click)="cancelar()">
                    <ion-icon name="close-outline" slot="start"></ion-icon>
                    Cancelar
                </ion-button>
                <ion-button type="button" color="danger" size="large" [disabled]="cadastroForm.invalid" (click)="onSubmit()">
                    <ion-icon name="checkmark-outline" slot="start"></ion-icon>
                    {{ isEditMode ? 'Atualizar Turma' : 'Cadastrar Turma' }}
                </ion-button>
                <ion-button *ngIf="isEditMode" fill="clear" color="danger" size="small" (click)="confirmarExclusao()">
                    <ion-icon name="trash-outline" slot="start"></ion-icon>
                    Excluir Turma
                </ion-button>
            </div>
        </form>
    </div>
</ion-content>